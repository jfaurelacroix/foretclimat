##################################
# Notebook server installation

sudo mkdir /media/data/setups/10.9
tar -xf ArcGIS_Notebook_Server_Linux_1091_180226.tar.gz -C /media/data/setups/10.9

# make sure that you have all the required tar files available (in /media/data/bkp_ArcGIS_files/)
## ArcGIS_Notebook_Docker_Advanced_109_177823.tar.gz
## ArcGIS_Notebook_Docker_Standard_109_177822.tar.gz
## ArcGIS_Notebook_Server_Linux_109_177908.tar.gz
## ArcGIS_Notebook_Server_Samples_Data_Linux_109_177914.tar.gz
## ArcGISNotebookServerAdvanced_ArcGISServer_1178969.prvc (authorization file)

# Change docker dir if needed https://enterprise.arcgis.com/en/notebook/latest/install/linux/install-docker-for-arcgis-notebook-server.htm

# Grab the authorization file
sudo cp ArcGISNotebookServerAdvanced_ArcGISServer_1178969.prvc /opt/software/authorization_files/10.9
# Installs Notebook Server, autorizes and creates site
# Manually tar -xf /media/data/bkp_ArcGIS_files/X.tar -C /media/data/setups/10.9 ?
sudo chef-client -z -j notebook-server.json
# Installs Web Adaptor if not already installed, registers notebook with the WA
sudo chef-client -z -j arcgis-notebook-server-webadaptor.json
# Federates Notebook with Enteprise Portal (PORT 7443 MUST BE OPEN)

sudo chef-client -z -j notebook-server-federation.json

##################################
# SETUP WEBSITE
# Create redirect to /portal/home
cd /opt/tomcat_arcgis/webapps
sudo mkdir ROOT
echo '<% response.sendRedirect("https://www.foretclimat.ca/portal/home/index.html"); %>' > ROOT/index.jsp
sudo chown -R arcgis ROOT
sudo chmod 755 -R ROOT

# Copy the files into /arcgis/portal/framework/webapps/arcgis#home/
# change index to home
sudo mv /arcgis/portal/framework/webapps/arcgis#home/index.html /arcgis/portal/framework/webapps/arcgis#home/home.html
sudo cp ~/repos/foretclimat/pages/* /arcgis/portal/framework/webapps/arcgis#home/
sudo cp ~/repos/foretclimat/media /arcgis/portal/framework/webapps/arcgis#home/

# If you don't plan adding standby machine in the future, don't configure the file server 
# and use local paths instead of shared directories for ArcGIS Server server directories, 
# Portal for ArcGIS content directory, and ArcGIS Data Store backup directories in arcgis-enterprise-primary.json.
